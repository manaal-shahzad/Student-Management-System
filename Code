#include <iostream>
#include <cstring>
#include <fstream>
using namespace std;

struct Student{
    char rollNo[20];
    char name[50];
    char dept[50];
    int noOfSubs;
    int marks[10];
    float average;
    char grade;
};

bool rollExists(Student* students, int count, const char roll[]){
    for(int i = 0; i < count; i++){
        if(strcmp(students[i].rollNo, roll) == 0){
        return true;
    }
    }
    return false;
}

char calcGrade(float average){
    if(average >= 85) return 'A';
    else if(average >= 70) return 'B';
    else if(average >= 60) return 'C';
    else if(average >= 50) return 'D';
    else return 'F';
}

void addStudent(Student* students, int &count, int size){
    if(count == size){
        cout << "No more space!";
        return;
    }

    char tempRollNo[20];
    
    cout << "Enter Roll Number: " << endl;
    cin >> ws;
    cin.getline(tempRollNo, 20);

    if(rollExists(students, count, tempRollNo)){
        cout << "Roll Number already exists!" << endl;
        return;
    }

    strcpy(students[count].rollNo, tempRollNo);

    cout << "Enter name: " << endl;
    cin >> ws;
    cin.getline(students[count].name, 50);

    cout << "Enter department: " << endl;
    cin >> ws;
    cin.getline(students[count].dept, 50);

    cout << "Enter number of subjects: " << endl;
    cin >> students[count].noOfSubs;

    for(int i = 0; i < students[count].noOfSubs; i++){
        cout << "Enter marks for subject " << i + 1 << ": " << endl;
        cin >> students[count].marks[i];
        if(students[count].marks[i] < 0 || students[count].marks[i] > 100){
            cout << "Enter valid marks(0-100)!";
            return;
        }
    }

    float sum = 0;

    for(int i = 0; i < students[count].noOfSubs; i++){
        sum = sum + students[count].marks[i];
    }

    students[count].average = sum / students[count].noOfSubs;

    students[count].grade = calcGrade(students[count].average);

    count++;

    cout << "Student added successfully!" << endl;
}

void displayStudents(Student* students, int count){
    if(count == 0){
        cout << "No student records to display." << endl;
        return;
    }

    cout << "\n---------------------------------------" << endl;
    cout << "            STUDENT RECORDS            " << endl;
    cout << "---------------------------------------" << endl;

    for(int i = 0; i < count; i++){
        cout << "STUDENT " << i + 1 << endl;
        cout << "Roll Number: " << students[i].rollNo << endl;
        cout << "Name: " << students[i].name << endl;
        cout << "Department: " << students[i].dept << endl;
        
        for(int j = 0; j < students[i].noOfSubs; j++){
            cout << "Marks " << j + 1 << ": " << students[i].marks[j] << endl;
        }

        cout << "Average: " << students[i].average << endl;
        cout << "Grade: " << students[i].grade << endl;

    }

    cout << "\n---------------------------------------" << endl;
}
